## Домашнее задание № 8 по курсу "MLOps"
### ML Deep Learning Service на Yandex Cloud
#### Автор: Кравченя Павел

#### Цель работы
В данном проекте необходимо построить Image classification-систему с использованием датасета CIFAR-10 и нейронной сети (TF/MXNET/Pytorch) на Yandex Cloud.

#### Постановка задачи

Требуется построить Image classification-систему с использованием датасета CIFAR-10 и нейронной сети (TF/MXNET/Pytorch) на Yandex Cloud. Реализовать систему как сервис, создать образ Docker'a и развернуть его в Kubernetes.

### Результаты выполнения работы

1. Система классификации изображений была построена с использованием сервиса `DataShere`. Исходный код ноутбука расположен в директории `notebook`. Так как сервис `DataSphere` по умолчанию не предоставляет ноутбуку доступ в интернет, датасет `Cifar-10` был загружен на сервис вручную. Датасет доступен [по ссылке](https://storage.yandexcloud.net/kpd-public-bucket/cifar10-dataset.tar). Обученная модель была помещена в zip-архив и загружена в бакет объектного хранилища Yandex Cloud. Модель доступна [по ссылке](https://storage.yandexcloud.net/kpd-public-bucket/cifar10-model.zip).

2. Для представления модели как сервиса использовался самописный проект на базе FastAPI, исходный код которого размещен в директории `service`. Данный сервис получает расположение zip-файла с моделью через переменную окружения `MODEL_NAME`, скачивает этот файл в локальную директорию, распаковывает, загружает из него keras-модель и добавляет в эту модель `softmax`-слой для получения вероятностей предсказанных классов. Полученная итоговая модель используется сервером `uvicorn` для формирования ответа при получении от пользователя HTTP-запроса с изображением.

3. Разработанный сервис был представлен в виде Docker-образа. Соответствующие `Dockerfile` и `docker-compose.yml`, предназначенные для сборки образа и размещения его в хранилище, расположены в директории `docker`.

4. Созданный docker-образ с сервисом был развернут в системе `Kubernetes`. Файлы `.yml` для создания соответствующих объектов Kubernetes расположены в директории `k8s`.

5. Процесс работы с сервисами Yandex Cloud __был записан на видео__. Видеофайл доступен [по ссылке](https://storage.yandexcloud.net/kpd-public-bucket/Otus_Task_8_DL_YandexCloud.mp4).

### Выводы
В процессе выполнения домашнего задания была реализована система классификации изображений на базе глубокой нейронной сети. Система представлена в виде сервиса, выполняющегося в Docker-контейнере, и развернута в системе Kubernetes. Выполнена проверка работоспособности представленного решения. В прецессе решения задачи использовались следующие сервисы Yandex Cloud:
1. `DataSphere` -- для обучения нейросети в Jupyter Notebook;
2. `Object Storage` -- для сохранения датасета и обученной модели;
3. `Compute Cloud` -- для запуска виртуальной машины, в которой собирался Docker-образ, и выполнялась работа с хранилищем образов и K8S;
4. `Container Registry` -- для сохранения Docker-образа с целью его последующего использования в K8s;
5. `Managed Service for Kubernetes` -- для развертывания сервиса и обеспечения его доступности из интернета.
